---
import AppLayout from '../layouts/AppLayout.astro';
import {Search} from '../components/Search';

const response = await fetch('https://search.sc2.gg/recent?refresh');

let results = {
  replays: [],
  players: [],
  maps: [],
  events: [],
};

if (response.ok) {
  results = await response.json();

  const occurrenceSort = (a, b) => b.occurrences - a.occurrences;

  results.players.sort(occurrenceSort);
  results.maps.sort(occurrenceSort);
  results.events.sort(occurrenceSort);
}
---
<AppLayout>
  <Search initialResults={results} client:load />
</AppLayout>
